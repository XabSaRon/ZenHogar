<div class="dialog-container">
  <button type="button" class="close-fab" mat-icon-button aria-label="Cerrar" (click)="cerrarDialogo()">
    <mat-icon fontIcon="close"></mat-icon>
  </button>

  <h1 class="titulo-modal">
    <span class="icon-wrapper">
      <mat-icon>star_rate</mat-icon>
    </span>
    <span>Valorar tarea</span>
  </h1>

  @if (data['nombreTarea']) {
  <p class="subtitulo-tarea">
    Â¿CÃ³mo se ha realizado <strong>{{ data['nombreTarea'] }}</strong>?
  </p>
  } @else {
  <p class="subtitulo-tarea">
    CuÃ©ntanos quÃ© tal se ha hecho esta tarea.
  </p>
  }

  @if (isDemoMode) {
  <div class="aviso-demo">
    ðŸ‘€ EstÃ¡s en modo demo â€” la valoraciÃ³n no se guardarÃ¡ realmente.
  </div>
  }

  <form #form="ngForm" (ngSubmit)="guardarValoracion()" class="dialog-body">

    <div class="valoracion-bloque">
      <div class="texto-valoracion">
        @if (valorSeleccionado === 0) {
        <span class="muted">Elige una puntuaciÃ³n de 1 a 5 estrellas</span>
        } @else {
        <span class="etiqueta-activa">
          {{ estrellas[valorSeleccionado - 1].etiqueta }}
        </span>
        }
      </div>

      <div class="valoracion-estrellas">
        <ng-container *ngFor="let estrella of estrellas">
          <button mat-icon-button type="button" (click)="seleccionarEstrella(estrella.valor)"
            [class.seleccionada]="estrella.valor <= valorSeleccionado" matTooltip="{{ estrella.etiqueta }}">
            <mat-icon>star</mat-icon>
          </button>
        </ng-container>
      </div>
    </div>

    <mat-form-field appearance="outline">
      <mat-label>Comentario (opcional)</mat-label>
      <textarea matInput name="comentario" [(ngModel)]="comentario" rows="3"
        placeholder="Â¿Algo que destacar? Ej: â€˜Ha quedado impecableâ€™ o â€˜PodrÃ­a haberse hecho mejorâ€™â€¦"></textarea>
    </mat-form-field>

    <div mat-dialog-actions class="acciones-dialogo">
      <button mat-button type="button" (click)="cerrarDialogo()">
        Cancelar
      </button>
      <button mat-flat-button color="primary" type="submit" [disabled]="valorSeleccionado === 0" class="btn-guardar">
        Guardar valoraciÃ³n
      </button>
    </div>
  </form>
</div>